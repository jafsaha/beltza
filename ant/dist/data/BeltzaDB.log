CREATE USER SA PASSWORD "" ADMIN
/*C1*/SET SCHEMA PUBLIC
CONNECT USER SA
SET AUTOCOMMIT FALSE
CREATE CACHED TABLE CONFIGURACION (nombre\u0009\u0009\u0009\u0009VARCHAR NOT NULL PRIMARY KEY,valor\u0009\u0009\u0009\u0009VARCHAR)
CREATE UNIQUE INDEX INX_CONFIGURACION ON CONFIGURACION (nombre)
CREATE CACHED TABLE ESPECIES (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,codigo\u0009\u0009\u0009\u0009VARCHAR(4) NOT NULL,aforo\u0009\u0009\u0009\u0009DOUBLE NOT NULL,stock\u0009\u0009\u0009\u0009DOUBLE NOT NULL,posicion\u0009\u0009\u0009DOUBLE NOT NULL,aforoInverso      \u0009BOOLEAN NOT NULL)
CREATE UNIQUE INDEX INX_ESPECIES ON ESPECIES (codigo)
CREATE CACHED TABLE CLIENTES (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,codigo\u0009\u0009\u0009\u0009VARCHAR NOT NULL)
CREATE UNIQUE INDEX INX_CLIENTES ON CLIENTES (codigo)
CREATE CACHED TABLE DIAS (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,fechaAsociada\u0009\u0009DATE NOT NULL,abierto\u0009\u0009      \u0009BOOLEAN,descripcion\u0009\u0009\u0009VARCHAR)
CREATE UNIQUE INDEX INX_DIAS ON DIAS (fechaAsociada)
CREATE CACHED TABLE CIERRES (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,diaId\u0009\u0009\u0009\u0009BIGINT NOT NULL,especieId\u0009\u0009\u0009BIGINT NOT NULL,aforo\u0009\u0009\u0009\u0009DOUBLE NOT NULL,stock\u0009\u0009\u0009\u0009DOUBLE NOT NULL,posicion\u0009\u0009\u0009DOUBLE NOT NULL,FOREIGN KEY (diaId) REFERENCES DIAS(id),FOREIGN KEY (especieId) REFERENCES ESPECIES(id))
CREATE CACHED TABLE OPERACIONES (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,numero\u0009\u0009\u0009\u0009BIGINT NOT NULL,fechaAlta\u0009\u0009\u0009DATE NOT NULL,fechaLiquidacion\u0009DATE, tipo\u0009\u0009\u0009\u0009VARCHAR NOT NULL, subTipo \u0009\u0009\u0009VARCHAR NOT NULL, diaId\u0009\u0009\u0009\u0009BIGINT NOT NULL,clienteId\u0009\u0009\u0009BIGINT,especieEntraId\u0009\u0009BIGINT,especieSaleId\u0009\u0009BIGINT,valorizacion\u0009\u0009DOUBLE,cantidad\u0009\u0009\u0009DOUBLE NOT NULL,cantidadSale\u0009\u0009DOUBLE,notas \u0009\u0009\u0009\u0009VARCHAR,FOREIGN KEY (diaId) REFERENCES DIAS(id),FOREIGN KEY (clienteId) REFERENCES CLIENTES(id),FOREIGN KEY (especieEntraId) REFERENCES ESPECIES(id),FOREIGN KEY (especieSaleId) REFERENCES ESPECIES(id))
       CREATE UNIQUE INDEX INX_OPERACIONES ON OPERACIONES (numero)
       CREATE CACHED TABLE MOVIMIENTOS (id\u0009\u0009\u0009\u0009\u0009BIGINT NOT NULL PRIMARY KEY,operacionId\u0009\u0009\u0009BIGINT NOT NULL,clienteId\u0009\u0009\u0009BIGINT,especieId\u0009\u0009\u0009BIGINT NOT NULL,diaId\u0009\u0009\u0009\u0009BIGINT NOT NULL,cantidad\u0009\u0009\u0009DOUBLE NOT NULL,valorizacion\u0009\u0009DOUBLE,tipo\u0009\u0009\u0009\u0009VARCHAR NOT NULL,liquidado\u0009\u0009\u0009BOOLEAN NOT NULL,fechaAlta\u0009\u0009\u0009DATE NOT NULL,fechaConcrecion\u0009\u0009DATE,diaConcrecionId\u0009\u0009BIGINT,FOREIGN KEY (operacionid) REFERENCES OPERACIONES(id) ON DELETE CASCADE,FOREIGN KEY (especieId) REFERENCES ESPECIES(id),FOREIGN KEY (diaId) REFERENCES DIAS(id),FOREIGN KEY (diaConcrecionId) REFERENCES DIAS(id))
CREATE INDEX INX_MOVIMIENTOS_1 ON MOVIMIENTOS (operacionId)
CREATE INDEX INX_MOVIMIENTOS_2 ON MOVIMIENTOS (operacionId, liquidado)
CREATE CACHED TABLE DUAL (id\u0009\u0009\u0009\u0009VARCHAR PRIMARY KEY)
INSERT INTO DUAL VALUES('1')
CREATE SEQUENCE SEQ_CLIENTES
CREATE SEQUENCE SEQ_ESPECIES
CREATE SEQUENCE SEQ_OPERACIONES
CREATE SEQUENCE SEQ_OPERACION_NUMERO
CREATE SEQUENCE SEQ_MOVIMIENTOS
CREATE SEQUENCE SEQ_DIAS
INSERT INTO ESPECIES VALUES(0,'BB',1.0E0,0.0E0,0.0E0,FALSE)
INSERT INTO ESPECIES VALUES(1,'$',0.33E0,0.0E0,0.0E0,TRUE)
ALTER SEQUENCE SEQ_ESPECIES RESTART WITH 2
COMMIT
DISCONNECT
/*C2*/SET SCHEMA PUBLIC
CONNECT USER SA
INSERT INTO CONFIGURACION VALUES('password','admin')
INSERT INTO CONFIGURACION VALUES('version','0')
SET AUTOCOMMIT FALSE
DELETE FROM CONFIGURACION WHERE NOMBRE='version'
INSERT INTO CONFIGURACION VALUES('version','23')
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
ALTER SEQUENCE SEQ_DIAS RESTART WITH 1
INSERT INTO DIAS VALUES(0,'2016-09-17',TRUE,NULL)
COMMIT
ALTER SEQUENCE SEQ_CLIENTES RESTART WITH 1
INSERT INTO CLIENTES VALUES(0,'cliente1')
ALTER SEQUENCE SEQ_ESPECIES RESTART WITH 3
INSERT INTO ESPECIES VALUES(2,'AY24',1.0E0,0.0E0,0.0E0,FALSE)
ALTER SEQUENCE SEQ_OPERACIONES RESTART WITH 1
ALTER SEQUENCE SEQ_OPERACION_NUMERO RESTART WITH 1
INSERT INTO OPERACIONES VALUES(0,0,'2016-09-18','2016-10-10','ALTA','MONEDA',0,0,2,NULL,866.0E0,12342.0E0,NULL,NULL)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 1
INSERT INTO MOVIMIENTOS VALUES(0,0,0,2,0,12342.0E0,NULL,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
DELETE FROM MOVIMIENTOS WHERE ID=0
INSERT INTO MOVIMIENTOS VALUES(0,0,0,2,0,12342.0E0,NULL,'ORIGINAL',TRUE,'2016-09-18','2016-09-18',0)
DELETE FROM ESPECIES WHERE ID=2
INSERT INTO ESPECIES VALUES(2,'AY24',1.0E0,-12342.0E0,0.0E0,FALSE)
COMMIT
ALTER SEQUENCE SEQ_CLIENTES RESTART WITH 2
INSERT INTO CLIENTES VALUES(1,'cliente2')
ALTER SEQUENCE SEQ_OPERACIONES RESTART WITH 2
ALTER SEQUENCE SEQ_OPERACION_NUMERO RESTART WITH 2
INSERT INTO OPERACIONES VALUES(1,1,'2016-09-18','2016-10-10','ALTA','MONEDA',0,1,2,NULL,866.0E0,12342.0E0,NULL,NULL)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 2
INSERT INTO MOVIMIENTOS VALUES(1,1,1,2,0,12342.0E0,NULL,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
DELETE FROM MOVIMIENTOS WHERE ID=1
INSERT INTO MOVIMIENTOS VALUES(1,1,1,2,0,12342.0E0,NULL,'ORIGINAL',TRUE,'2016-09-18','2016-09-18',0)
DELETE FROM ESPECIES WHERE ID=2
INSERT INTO ESPECIES VALUES(2,'AY24',1.0E0,-24684.0E0,0.0E0,FALSE)
COMMIT
ALTER SEQUENCE SEQ_CLIENTES RESTART WITH 3
INSERT INTO CLIENTES VALUES(2,'cliente3')
ALTER SEQUENCE SEQ_OPERACIONES RESTART WITH 3
ALTER SEQUENCE SEQ_OPERACION_NUMERO RESTART WITH 3
INSERT INTO OPERACIONES VALUES(2,2,'2016-09-18','2016-10-10','ALTA','MONEDA',0,2,2,NULL,866.0E0,12342.0E0,NULL,NULL)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 3
INSERT INTO MOVIMIENTOS VALUES(2,2,2,2,0,12342.0E0,NULL,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
DELETE FROM MOVIMIENTOS WHERE ID=2
INSERT INTO MOVIMIENTOS VALUES(2,2,2,2,0,12342.0E0,NULL,'ORIGINAL',TRUE,'2016-09-18','2016-09-18',0)
DELETE FROM ESPECIES WHERE ID=2
INSERT INTO ESPECIES VALUES(2,'AY24',1.0E0,-37026.0E0,0.0E0,FALSE)
COMMIT
ALTER SEQUENCE SEQ_CLIENTES RESTART WITH 4
INSERT INTO CLIENTES VALUES(3,'112')
ALTER SEQUENCE SEQ_ESPECIES RESTART WITH 4
INSERT INTO ESPECIES VALUES(3,'AAA',1.0E0,0.0E0,0.0E0,FALSE)
ALTER SEQUENCE SEQ_ESPECIES RESTART WITH 5
INSERT INTO ESPECIES VALUES(4,'21',1.0E0,0.0E0,0.0E0,FALSE)
ALTER SEQUENCE SEQ_OPERACIONES RESTART WITH 4
ALTER SEQUENCE SEQ_OPERACION_NUMERO RESTART WITH 4
INSERT INTO OPERACIONES VALUES(3,3,'2016-09-18','2016-09-20','COMPRA','MONEDA',0,3,3,4,2222.0E0,2.0E0,NULL,'Lalala')
DELETE FROM ESPECIES WHERE ID=3
INSERT INTO ESPECIES VALUES(3,'AAA',2222.0E0,0.0E0,0.0E0,FALSE)
DELETE FROM ESPECIES WHERE ID=3
INSERT INTO ESPECIES VALUES(3,'AAA',2222.0E0,0.0E0,2.0E0,FALSE)
DELETE FROM ESPECIES WHERE ID=4
INSERT INTO ESPECIES VALUES(4,'21',1.0E0,0.0E0,-4444.0E0,FALSE)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 4
INSERT INTO MOVIMIENTOS VALUES(3,3,3,3,0,2.0E0,2222.0E0,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 5
INSERT INTO MOVIMIENTOS VALUES(4,3,3,4,0,-4444.0E0,2222.0E0,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
COMMIT
ALTER SEQUENCE SEQ_OPERACIONES RESTART WITH 5
ALTER SEQUENCE SEQ_OPERACION_NUMERO RESTART WITH 5
INSERT INTO OPERACIONES VALUES(4,4,'2016-09-18','2016-09-20','COMPRA','MONEDA',0,3,3,4,2222.0E0,2.0E0,NULL,'Lalala')
DELETE FROM ESPECIES WHERE ID=3
INSERT INTO ESPECIES VALUES(3,'AAA',2222.0E0,0.0E0,2.0E0,FALSE)
DELETE FROM ESPECIES WHERE ID=3
INSERT INTO ESPECIES VALUES(3,'AAA',2222.0E0,0.0E0,4.0E0,FALSE)
DELETE FROM ESPECIES WHERE ID=4
INSERT INTO ESPECIES VALUES(4,'21',1.0E0,0.0E0,-8888.0E0,FALSE)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 6
INSERT INTO MOVIMIENTOS VALUES(5,4,3,3,0,2.0E0,2222.0E0,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
ALTER SEQUENCE SEQ_MOVIMIENTOS RESTART WITH 7
INSERT INTO MOVIMIENTOS VALUES(6,4,3,4,0,-4444.0E0,2222.0E0,'ORIGINAL',FALSE,'2016-09-18',NULL,NULL)
COMMIT
